<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Slither.io ModMenu 完全版</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Agu+Display&display=swap" rel="stylesheet">
<style>
body {
    font-family: 'Agu Display', sans-serif;
    color: #FFFFFF;
    -webkit-user-select: none;
    user-select: none;
    -webkit-user-drag: none;
}

.farstcontent {
    background-color: #1F7035Fb;
    width: 295px;
    height: 160px;
    display: block;
    padding-left: 5px;
}

.start-button {
    background-color: #961D32;
    color: white;
    padding: 5px 10px;
    border: none;
    cursor: pointer;
    font-size: 15px;
    margin: 10px 0;
    border: solid 1px #676770;
    height: 40px;
}

.start-button:hover {
    background-color: #961D32;
}

/* 移動可能なZoom枠 */
#zoomContainer {
    position: absolute;
    top: 50px;
    left: 50px;
    padding: 10px 15px;
    background-color: #961D32;
    border: 1px solid #676770;
    color: white;
    cursor: grab;
    z-index: 9999;
    user-select: none;
    display: flex;
    align-items: center;
    gap: 10px;
}

#zoomContainer button {
    width: 50px;
    height: 30px;
    font-size: 16px;
}
#zoomValue {
    min-width: 40px;
    text-align: center;
}
</style>
</head>
<body>

<div class="farstcontent">
    <button class="start-button" onclick="startExecution()">click!!</button>
    <p>Once you play AI or online, click the button in play or on the Home Screen</p>
</div>

<!-- 自由に移動できるZoom枠 -->
<div id="zoomContainer">
    <button id="zoomOut">-</button>
    <span id="zoomValue">0.70</span>
    <button id="zoomIn">+</button>
</div>

<script>
let baseAddress = null; // h5gg で取得するアドレス
let currentZoom = 0.70; // 初期値

function startExecution() {
    alert('startExecution() が呼ばれました。ここで baseAddress を取得できます。');
}

// Zoom値を h5gg に適用
function applyZoom() {
    if (!baseAddress) return;
    const baseAddrNum = parseInt(baseAddress, 16);
    const zoomAddr = baseAddrNum - 0x260;
    h5gg.setValue("0x" + zoomAddr.toString(16), currentZoom, 'F64');
    document.getElementById("zoomValue").innerText = currentZoom.toFixed(2);
}

// Zoomインボタン
document.getElementById("zoomIn").addEventListener("click", () => {
    currentZoom += 0.10;
    if(currentZoom > 1.0) currentZoom = 1.0;
    applyZoom();
});

// Zoomアウトボタン
document.getElementById("zoomOut").addEventListener("click", () => {
    currentZoom -= 0.10;
    if(currentZoom < 0.01) currentZoom = 0.01;
    applyZoom();
});

// 移動機能
const zoomContainer = document.getElementById('zoomContainer');
let isDragging = false;
let offsetX, offsetY;

zoomContainer.addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - zoomContainer.offsetLeft;
    offsetY = e.clientY - zoomContainer.offsetTop;
    zoomContainer.style.cursor = 'grabbing';
});

document.addEventListener('mousemove', (e) => {
    if(!isDragging) return;
    zoomContainer.style.left = (e.clientX - offsetX) + 'px';
    zoomContainer.style.top = (e.clientY - offsetY) + 'px';
});

document.addEventListener('mouseup', () => {
    if(isDragging) {
        isDragging = false;
        zoomContainer.style.cursor = 'grab';
    }
});
</script>
</body>
</html>